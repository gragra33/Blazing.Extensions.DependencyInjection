@*
    ToggleInput.razor
    
    A form-bound toggle switch input component for use within EditForm or EditContext scenarios.
    Inherits from InputBase<bool> providing full form validation and data binding support.
    
    Features:
    - Full EditForm integration with validation support
    - Customizable label and state text (On/Off labels)
    - Two position options (Left or Right toggle position)
    - Full keyboard accessibility (Space/Enter to toggle)
    - ARIA-compliant for screen readers
    - Disabled and read-only states
    - Automatic two-way data binding via CurrentValue
    - Form validation error display
    
    Usage:
    <EditForm Model="model" OnValidSubmit="HandleSubmit">
        <ToggleInput @bind-Value="model.IsEnabled" Label="Enable Feature" />
        <ValidationMessage For="@(() => model.IsEnabled)" />
        <button type="submit">Submit</button>
    </EditForm>
    
    Component Parameters (see ToggleInput.razor.cs for details):
    - Value: The current toggle state (bool) - for two-way binding
    - Label: Display text for the toggle label
    - LabelContent: RenderFragment for custom label content
    - OnText: Text displayed when toggle is on
    - OffText: Text displayed when toggle is off
    - Position: TogglePosition.Left or TogglePosition.Right
    - DefaultValue: Initial value when component loads
    - Disabled: Disable user interaction
    - ReadOnly: Prevent value changes but allow focus
    - CssClass: Additional CSS classes
    - Style: Inline styles
*@
@inherits ComponentInputControlBase<bool>
@using CSS = Blazing.ToggleSwitch.Blazor.Css.CssClass.Toggle

<div class="@Classname" style="@Style">
    @if (HasLabel())
    {
        <div id="@LabelId" class="@CSS.Label">
            @if (LabelContent is not null)
            {
                @LabelContent
            }
            else
            {
                @Label
            }
        </div>
    }
    <div class="@CSS.Container">
        @if (Position == TogglePosition.Left)
        {
            <input type="checkbox" role="switch"
                   id="@PillId" class="@CSS.Pill"
                   aria-labelledby="@StateLabelId" aria-checked="@CurrentValue.ToString().ToLower()" aria-readonly="@Disabled.ToString().ToLower()"
                   @bind=CurrentValue disabled="@Disabled"
                   @onclick:preventDefault="@ReadOnly"/>

            <label class="@CSS.Thumb" for="@PillId" aria-labelledby="@LabelId"
                   data-label="@StateLabel" data-label-on="@OnText" data-label-off="@OffText"
                   tabindex="0"
                   @onkeydown="@(OnKeyDownAsync)"
                   @onkeydown:preventDefault="true"
                   @onkeydown:stopPropagation="true">
                <span class="@CSS.ThumbInner"></span>
            </label>

            @if (HasOnOffLabel())
            {
                <span id="@StateLabelId" class="@CSS.State">@StateLabel</span>
            }
        }
        else
        {
            @if (HasOnOffLabel())
            {
                <span id="@StateLabelId" class="@CSS.State">@StateLabel</span>
            }

            <input type="checkbox" role="switch"
                   id="@PillId" class="@CSS.Pill"
                   aria-labelledby="@StateLabelId" aria-checked="@CurrentValue.ToString().ToLower()" aria-readonly="@Disabled.ToString().ToLower()"
                   @bind=CurrentValue disabled="@Disabled"
                   @onclick:preventDefault="@ReadOnly"/>

            <label class="@CSS.Thumb" for="@PillId" aria-labelledby="@LabelId"
                   data-label="@StateLabel" data-label-on="@OnText" data-label-off="@OffText"
                   tabindex="0"
                   @onkeydown="@(OnKeyDownAsync)"
                   @onkeydown:preventDefault="true"
                   @onkeydown:stopPropagation="true">
                <span class="@CSS.ThumbInner"></span>
            </label>
        }
    </div>
</div>